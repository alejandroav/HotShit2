<div class="row center-align">
	<div class="col s8 m8 l8 offset-s2 offset-m2 offset-l2 zona-imagen">
		<img src="uploads/users/noimage.jpg" class="imagen-perfil">
	</div>
</div>
<div class="row center-align" id="data-perfil">
        <div class="col s3 m3 l2 offset-l2 data-inside">Eventos asistidos <div id="event-assisted"></div></div>
        <div class="col s3 m3 l2 data-inside">Suscriptores <div id="suscribers"></div></div>
        <div class="col s3 m3 l2 data-inside">Suscripciones <div id="suscribed"></div></div>
        <div class="col s3 m3 l2 data-inside">Eventos creados <div id="goals-done"></div></div>
</div>
  <div class="row center-align">
    <div class="col s12 m12 l8 offset-l2">
      <ul class="tabs" id="tabla2">
        <li class="tab col s12 col-sus"><a href="#test1">Suscripciones</a></li>
        <li class="tab col s12 col-gen"><a class="active" href="#test2">General</a></li>
        <li class="tab col s12 col-amig"><a href="#test3">Tus amigos van a...</a></li>
      </ul>
    </div>
    <div id="test1" class="col s12 m12 l6 offset-l3">
		<div class="preloader-wrapper big active" style="margin-top: 20px;">
			<div class="spinner-layer spinner-blue-only">
				<div class="circle-clipper left">
					<div class="circle"></div>
				</div>
				<div class="gap-patch">
					<div class="circle"></div>
				</div>
				<div class="circle-clipper right">
					<div class="circle"></div>
				</div>
			</div>
		</div>
	</div>
    <div id="test2" class="col s12 m12 l6 offset-l3">
		<div class="preloader-wrapper big active" style="margin-top: 20px;">
			<div class="spinner-layer spinner-blue-only">
				<div class="circle-clipper left">
					<div class="circle"></div>
				</div>
				<div class="gap-patch">
					<div class="circle"></div>
				</div>
				<div class="circle-clipper right">
					<div class="circle"></div>
				</div>
			</div>
		</div>
	</div>
    <div id="test3" class="col s12 m12 l6 offset-l3">
		<div class="preloader-wrapper big active" style="margin-top: 20px;">
			<div class="spinner-layer spinner-blue-only">
				<div class="circle-clipper left">
					<div class="circle"></div>
				</div>
				<div class="gap-patch">
					<div class="circle"></div>
				</div>
				<div class="circle-clipper right">
					<div class="circle"></div>
				</div>
			</div>
		</div>
	</div>
  <script>
	$(document).ready(function(){
		$('#tabla2').tabs();
		socket.emit('c-event-statistics');
		socket.emit('c-event-list', {loc_long: 0, loc_lat: 0, radio: 1000, type: 0});
		socket.emit('c-event-list', {loc_long: 0, loc_lat: 0, radio: 1000, type: 1});
		socket.emit('c-event-list', {loc_long: 0, loc_lat: 0, radio: 1000, type: 2});
		socket.on('s-event-statistics', function (data){
			if (data.status == "OK");
			$("#event-assisted").html(data.data.goevents);
			$("#suscribers").html(data.data.followed);
			$("#suscribed").html(data.data.followers);
			$("#goals-done").html(data.data.myevents);
		});
		socket.on('s-event-list', function(data) {
			if (data.status == "OK"){
				var container = $(document.createElement("div"));
				if ('data' in data && data.data.length > 0){
					$.ajax({
						url: "pages/detalle.html",
						success: function(res) {
							for (var i = 0; i<data.data.length; i++){
								var obj = data.data[i];
								var res2 = $(res);
								date = obj.date.split("-");
								year = date[0];
								month = date[1];
								day = date[2].split("T")[0];
								res2.find(".titulotarjeta").html(obj.title);
								res2.find(".descripciontarjeta").html(obj.description);
								res2.find(".user-dist").html(Math.round(obj.distance)+"km");
								res2.find(".user-price").html(obj.cost);
								res2.find(".user-time").html(day+"/"+month+"/"+year);
								res2.find(".user-assist").html(obj.current+"/"+obj.capacity);
								container.append(res2);
							}
							if (data.type == 0) $("#test2").html(container);
							else if (data.type == 1) $("#test1").html(container);
							else if (data.type == 2) $("#test3").html(container);
						}
					});
				//console.log(container);
				} else container.html("No hay eventos disponibles");
			} else if (typeof data.msg == "string") Materialize.toast("Error: "+data.msg, 3000);
			else console.log(data.msg);
		});
	});
  </script>